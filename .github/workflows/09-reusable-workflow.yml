# 09 - CALLING REUSABLE WORKFLOWS
# DRY principle: call shared workflows with 'uses' at job level
# Path: ./.github/workflows/name.yml (same repo) or owner/repo/path@ref (external)

name: 09 - Call Reusable Workflow

on:
  push:
    branches: [ main, copilot/** ]
  workflow_dispatch:

jobs:
  # CALL WITH DEV CONFIG
  call-reusable-dev:
    name: Call Reusable Workflow (Dev)
    uses: ./.github/workflows/reusable-build.yml
    with:
      environment: dev
      node-version: '18'
      
  # CALL WITH PROD CONFIG - same workflow, different inputs
  call-reusable-prod:
    name: Call Reusable Workflow (Prod)
    uses: ./.github/workflows/reusable-build.yml
    with:
      environment: production
      node-version: '20'
    # Secrets must be explicitly passed:
    # secrets:
    #   deploy-token: ${{ secrets.PROD_DEPLOY_TOKEN }}
      
  # USE OUTPUTS from reusable workflow
  use-outputs:
    name: Use Reusable Workflow Outputs
    needs: call-reusable-dev
    runs-on: ubuntu-latest
    steps:
      # Access via needs.<job-id>.outputs.<output-name>
      - name: Display outputs
        run: |
          echo "Build status: ${{ needs.call-reusable-dev.outputs.build-status }}"
          echo "Benefits: DRY, consistency, easier maintenance"
