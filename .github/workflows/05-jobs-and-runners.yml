# 05 - MULTIPLE JOBS AND RUNNERS
# Parallel jobs, different OS runners, job dependencies, matrix strategy

name: 05 - Multiple Jobs and Runners

on:
  push:
    branches: [ main, copilot/** ]
  workflow_dispatch:

jobs:
  # UBUNTU RUNNER
  ubuntu-job:
    name: Ubuntu Runner
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Display OS info
        run: |
          echo "Running on Ubuntu"
          uname -a
          
  # WINDOWS RUNNER - uses PowerShell by default
  windows-job:
    name: Windows Runner
    runs-on: windows-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Display OS info
        run: |
          echo "Running on Windows"
          systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
          
  # MACOS RUNNER
  macos-job:
    name: macOS Runner
    runs-on: macos-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Display OS info
        run: |
          echo "Running on macOS"
          sw_vers
          
  # DEPENDENT JOB - 'needs' creates sequential execution
  dependent-job:
    name: Dependent Job
    runs-on: ubuntu-latest
    needs: ubuntu-job
    steps:
      - name: Display dependency info
        run: echo "This job runs after ubuntu-job completes"
          
  # MATRIX STRATEGY - parallel testing across configurations
  # 2 OS Ã— 2 Node versions = 4 parallel jobs
  matrix-job:
    name: Matrix - ${{ matrix.os }} / Node ${{ matrix.node }}
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest]
        node: [18, 20]
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node }}
      - name: Display versions
        run: |
          node --version
          npm --version
