# 07 - USING SECRETS
# Repository, environment, and organization secrets; automatic masking in logs
# Never commit secrets; use environments for protection rules

name: 07 - Using Secrets

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Environment to use'
        required: true
        type: choice
        options: [dev, staging, production]

jobs:
  use-secrets:
    name: Use Secrets Example
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}  # Enables environment-specific secrets
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      # Access via ${{ secrets.SECRET_NAME }} - values are auto-masked as ***
      - name: Use repository secret (demo)
        run: |
          echo "Secrets are accessed via \${{ secrets.SECRET_NAME }}"
          echo "Values are automatically masked in logs"
          
      - name: Use secret in script
        env:
          # Pass secrets as env vars (not command args)
          # API_KEY: ${{ secrets.API_KEY }}
          ENV_NAME: ${{ inputs.environment }}
        run: |
          echo "Environment: $ENV_NAME"
          echo "Use cases: API keys, DB passwords, deploy tokens"
          
      - name: Best practices for secrets
        run: |
          echo "1. Never commit secrets to repository"
          echo "2. Use environments for environment-specific secrets"
          echo "3. Rotate secrets regularly"
          echo "4. Use least privilege principle"
