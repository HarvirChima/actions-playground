name: 07 - Using Secrets

# This workflow demonstrates secrets usage
# - Accessing repository secrets
# - Environment-specific secrets
# - Masking sensitive data in logs

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Environment to use'
        required: true
        type: choice
        options:
          - dev
          - staging
          - production

jobs:
  use-secrets:
    name: Use Secrets Example
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Use repository secret (demo)
        run: |
          echo "Accessing secrets in GitHub Actions"
          echo "Note: Secrets are automatically masked in logs"
          # In real usage: echo "${{ secrets.MY_SECRET }}"
          # The secret value will be replaced with *** in logs
          
      - name: Demonstrate secret masking
        run: |
          echo "If you print a secret, it will show as ***"
          echo "This protects sensitive data in workflow logs"
          
      - name: Use secret in script
        env:
          # API_KEY: ${{ secrets.API_KEY }}
          # DB_PASSWORD: ${{ secrets.DB_PASSWORD }}
          ENV_NAME: ${{ inputs.environment }}
        run: |
          echo "Environment: $ENV_NAME"
          echo "In production, you would use secrets like:"
          echo "  - API keys for external services"
          echo "  - Database passwords"
          echo "  - Deployment tokens"
          echo "  - SSH keys"
          
      - name: Best practices for secrets
        run: |
          echo "Secret Best Practices:"
          echo "1. Never commit secrets to repository"
          echo "2. Use GitHub secrets for sensitive data"
          echo "3. Use environments for environment-specific secrets"
          echo "4. Rotate secrets regularly"
          echo "5. Use least privilege principle"
          echo "6. Consider using encrypted secrets at rest"
